/* ============================================================================
   フォーム・UI コンポーネント - 2025年モダンデザイン
   ============================================================================ */

@layer components {
    /* ============================================================================
       基本フォームグループ
       ============================================================================ */

    .form-group {
        @apply mb-6 relative;
        animation: slideUp 0.4s ease-out;
    }

    .form-group label {
        @apply block mb-3 font-semibold text-neutral-700 
               transition-colors duration-200;
        font-size: 0.95rem;
        letter-spacing: 0.01em;
    }

    .form-group label.required {
        position: relative;
    }

    .form-group label.required::after {
        content: "*";
        @apply text-coral-500 ml-1;
        font-weight: bold;
    }

    /* ============================================================================
       統一されたフォーム入力要素 - グラスモーフィズム
       ============================================================================ */

    .form-input-base {
        @apply w-full px-4 py-3 text-base
               border-2 border-transparent rounded-xl
               transition-all duration-300 ease-out
               focus:outline-none focus:ring-0
               disabled:opacity-50 disabled:cursor-not-allowed
               placeholder-neutral-400;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(164, 120, 100, 0.2);
        box-shadow: inset 0 2px 4px rgba(164, 120, 100, 0.05),
            0 1px 2px rgba(164, 120, 100, 0.05);
        min-height: 48px;
        position: relative;
    }

    .form-input-base:focus {
        background: rgba(255, 255, 255, 0.95);
        border-color: rgba(164, 120, 100, 0.5);
        box-shadow: inset 0 2px 4px rgba(164, 120, 100, 0.1),
            0 0 0 3px rgba(164, 120, 100, 0.15),
            0 4px 12px rgba(164, 120, 100, 0.1);
        transform: translateY(-1px);
    }

    .form-input-base:hover:not(:focus):not(:disabled) {
        border-color: rgba(164, 120, 100, 0.3);
        background: rgba(255, 255, 255, 0.9);
    }

    .form-input-base:disabled {
        background: rgba(240, 240, 240, 0.8);
        border-color: rgba(164, 120, 100, 0.1);
        color: theme("colors.neutral.400");
    }

    /* テキストエリア専用 */
    .form-textarea-base {
        @apply form-input-base resize-y;
        min-height: 120px;
        padding-top: 1rem;
        padding-bottom: 1rem;
        line-height: 1.6;
    }

    /* セレクト要素 */
    .form-select-base {
        @apply form-input-base cursor-pointer pr-12 bg-no-repeat bg-right;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%23a47864'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
        background-size: 20px;
        background-position: right 16px center;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
    }

    .form-select-base:focus {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%235d3e2b'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
    }

    /* ============================================================================
       フローティングラベル
       ============================================================================ */

    .form-floating {
        @apply relative;
    }

    .form-floating .form-input-base {
        @apply pt-6 pb-2;
    }

    .form-floating label {
        @apply absolute left-4 top-4 text-neutral-500 text-sm
               transition-all duration-200 pointer-events-none
               transform origin-top-left;
    }

    .form-floating .form-input-base:focus + label,
    .form-floating .form-input-base:not(:placeholder-shown) + label {
        @apply text-xs text-mocha-600;
        transform: translateY(-0.75rem) scale(0.85);
    }

    /* ============================================================================
       店舗検索コンテナ
       ============================================================================ */

    .shop-search-container {
        @apply relative mb-6 w-full max-w-md;
    }

    .shop-search-input {
        @apply form-input-base pr-12;
        position: relative;
    }

    .shop-search-icon {
        @apply absolute right-4 top-1/2 transform -translate-y-1/2
               text-neutral-400 pointer-events-none;
    }

    .search-results {
        @apply absolute top-full left-0 right-0 mt-1
               bg-white border border-neutral-200 
               max-h-64 overflow-y-auto z-50 hidden
               rounded-xl shadow-lg;
        backdrop-filter: blur(15px);
        -webkit-backdrop-filter: blur(15px);
        background: rgba(255, 255, 255, 0.95);
    }

    .search-results.show {
        @apply block;
        animation: slideDown 0.3s ease-out;
    }

    .search-result-item {
        @apply p-4 cursor-pointer border-b border-neutral-100 
               transition-all duration-200 hover:bg-mocha-50
               flex items-center gap-3;
    }

    .search-result-item:last-child {
        @apply border-b-0;
    }

    .search-result-item:hover {
        background: linear-gradient(
            135deg,
            rgba(164, 120, 100, 0.05),
            rgba(135, 169, 107, 0.05)
        );
    }

    .search-result-item .shop-icon {
        @apply w-5 h-5 text-mocha-500 flex-shrink-0;
    }

    .search-result-item .shop-info {
        @apply flex-1 min-w-0;
    }

    .search-result-item .shop-name {
        @apply font-medium text-neutral-900 truncate;
    }

    .search-result-item .shop-address {
        @apply text-sm text-neutral-500 truncate;
    }

    /* ============================================================================
       チェックボックス・ラジオボタン - カスタムデザイン
       ============================================================================ */

    .form-checkbox-container,
    .form-radio-container {
        @apply flex items-center gap-3 py-2;
    }

    .form-checkbox,
    .form-radio {
        @apply w-5 h-5 cursor-pointer appearance-none
               border-2 border-neutral-300 
               transition-all duration-200 ease-out
               focus:outline-none focus:ring-2 focus:ring-mocha-500 focus:ring-offset-2;
        background: rgba(255, 255, 255, 0.8);
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        position: relative;
    }

    .form-checkbox {
        @apply rounded-md;
    }

    .form-radio {
        @apply rounded-full;
    }

    .form-checkbox:checked,
    .form-radio:checked {
        @apply border-mocha-500;
        background: linear-gradient(
            135deg,
            var(--color-mocha-500),
            var(--color-sage-500)
        );
    }

    .form-checkbox:checked::after {
        content: "✓";
        @apply absolute inset-0 flex items-center justify-center
               text-white text-sm font-bold;
    }

    .form-radio:checked::after {
        content: "";
        @apply absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2
               w-2 h-2 bg-white rounded-full;
    }

    .form-checkbox:hover:not(:checked),
    .form-radio:hover:not(:checked) {
        @apply border-mocha-400;
        background: rgba(164, 120, 100, 0.05);
    }

    /* ============================================================================
       ファイルアップロード - ドラッグ&ドロップ対応
       ============================================================================ */

    .form-file-input {
        @apply hidden;
    }

    .form-file-label {
        @apply flex flex-col items-center justify-center
               border-2 border-dashed border-neutral-300 rounded-xl
               text-neutral-600 hover:text-neutral-800 hover:border-mocha-400
               transition-all duration-300 cursor-pointer p-8;
        min-height: 160px;
        background: linear-gradient(
            135deg,
            rgba(164, 120, 100, 0.02),
            rgba(135, 169, 107, 0.02)
        );
        backdrop-filter: blur(5px);
        -webkit-backdrop-filter: blur(5px);
        position: relative;
        overflow: hidden;
    }

    .form-file-label::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
            90deg,
            transparent,
            rgba(164, 120, 100, 0.05),
            transparent
        );
        transition: left 0.6s ease-out;
    }

    .form-file-label:hover::before {
        left: 100%;
    }

    .form-file-label:hover {
        background: linear-gradient(
            135deg,
            rgba(164, 120, 100, 0.05),
            rgba(135, 169, 107, 0.05)
        );
        border-color: rgba(164, 120, 100, 0.4);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(164, 120, 100, 0.1);
    }

    .form-file-label.dragover {
        @apply border-mocha-500 bg-mocha-50 text-mocha-700;
        background: linear-gradient(
            135deg,
            rgba(164, 120, 100, 0.1),
            rgba(135, 169, 107, 0.1)
        );
    }

    .form-file-label.has-file {
        @apply border-success-400 bg-success-50 text-success-700;
    }

    .form-file-icon {
        @apply w-12 h-12 text-neutral-400 mb-3;
    }

    .form-file-label:hover .form-file-icon {
        @apply text-mocha-500;
        animation: bounceGentle 0.6s ease-out;
    }

    .form-file-text {
        @apply text-center;
    }

    .form-file-primary {
        @apply font-semibold mb-1;
    }

    .form-file-secondary {
        @apply text-sm text-neutral-500;
    }

    /* ============================================================================
       フォームバリデーション状態
       ============================================================================ */

    .form-group.has-error .form-input-base,
    .form-group.has-error .form-textarea-base,
    .form-group.has-error .form-select-base {
        @apply border-error-400;
        background: rgba(239, 68, 68, 0.05);
        box-shadow: inset 0 2px 4px rgba(239, 68, 68, 0.1),
            0 0 0 3px rgba(239, 68, 68, 0.1);
    }

    .form-group.has-error label {
        @apply text-error-600;
    }

    .form-group.has-success .form-input-base,
    .form-group.has-success .form-textarea-base,
    .form-group.has-success .form-select-base {
        @apply border-success-400;
        background: rgba(34, 197, 94, 0.05);
        box-shadow: inset 0 2px 4px rgba(34, 197, 94, 0.1),
            0 0 0 3px rgba(34, 197, 94, 0.1);
    }

    .form-group.has-success label {
        @apply text-success-600;
    }

    /* ============================================================================
       フォームメッセージ
       ============================================================================ */

    .form-message {
        @apply mt-2 text-sm flex items-center gap-2;
        animation: slideDown 0.3s ease-out;
    }

    .form-error {
        @apply form-message text-error-600;
    }

    .form-success {
        @apply form-message text-success-600;
    }

    .form-help {
        @apply form-message text-neutral-500;
    }

    .form-message i {
        @apply text-xs flex-shrink-0;
    }

    /* ============================================================================
       フォームグループ - 特殊レイアウト
       ============================================================================ */

    .form-group-inline {
        @apply flex items-center gap-4 mb-6;
    }

    .form-group-inline label {
        @apply mb-0 flex-shrink-0;
    }

    .form-group-inline .form-input-base {
        @apply flex-1;
    }

    .form-group-split {
        @apply grid grid-cols-1 md:grid-cols-2 gap-4 mb-6;
    }

    .form-group-triple {
        @apply grid grid-cols-1 md:grid-cols-3 gap-4 mb-6;
    }

    /* ============================================================================
       共通リンクスタイル
       ============================================================================ */

    .shop-link {
        @apply inline-flex items-center gap-2 text-mocha-600 
               font-semibold hover:text-mocha-700 
               transition-all duration-200;
        text-decoration: none;
    }

    .shop-link:hover {
        text-decoration: underline;
        text-decoration-color: var(--color-mocha-600);
        text-underline-offset: 3px;
        text-decoration-thickness: 2px;
    }

    .shop-link i {
        @apply transition-transform duration-200;
    }

    .shop-link:hover i {
        transform: scale(1.1);
    }

    /* ============================================================================
       予算表示
       ============================================================================ */

    .budget {
        @apply inline-flex items-center gap-1 px-3 py-1
               bg-gradient-to-r from-warning-100 to-warning-200
               text-warning-800 font-bold text-sm rounded-full
               border border-warning-300;
    }

    .budget i {
        @apply text-warning-600;
    }

    /* ============================================================================
       セクションタイトル
       ============================================================================ */

    .section-title {
        @apply text-xl font-semibold text-neutral-900 mb-6
               flex items-center gap-3 relative;
    }

    .section-title::after {
        content: "";
        @apply flex-1 h-px bg-gradient-to-r from-mocha-300 to-transparent;
    }

    .section-title i {
        @apply text-mocha-500;
    }

    /* ============================================================================
       ページネーション調整
       ============================================================================ */

    .pagination-wrapper {
        @apply flex justify-center mt-8;
    }

    .pagination-wrapper .pagination {
        @apply flex items-center gap-2;
    }

    .pagination-wrapper .page-link {
        @apply px-3 py-2 text-sm font-medium rounded-lg
               text-neutral-600 hover:text-neutral-900
               bg-white hover:bg-neutral-50
               border border-neutral-200 hover:border-neutral-300
               transition-all duration-200;
    }

    .pagination-wrapper .page-link.active {
        @apply bg-mocha-500 text-white border-mocha-500;
    }

    /* ============================================================================
       フォームアクション
       ============================================================================ */

    .form-actions {
        @apply flex flex-wrap gap-3 pt-6 mt-6 
               border-t border-neutral-200;
    }

    .form-actions .btn {
        @apply glass-btn transition-all duration-200 
               hover:-translate-y-0.5 hover:shadow-lg;
    }

    .form-actions .btn-primary {
        @apply bg-gradient-to-r from-mocha-500 to-mocha-600
               text-white border-mocha-500 hover:from-mocha-600 hover:to-mocha-700;
    }

    .form-actions .btn-secondary {
        @apply bg-gradient-to-r from-sage-500 to-sage-600
               text-white border-sage-500 hover:from-sage-600 hover:to-sage-700;
    }

    .form-actions .btn-outline {
        @apply border-2 border-neutral-400 text-neutral-600 
               hover:bg-neutral-500 hover:text-white hover:border-neutral-500;
    }

    /* ============================================================================
       レスポンシブ対応
       ============================================================================ */

    @media (max-width: 768px) {
        .form-group {
            @apply mb-4;
        }

        .form-input-base,
        .form-textarea-base,
        .form-select-base {
            @apply text-base;
            min-height: 44px;
        }

        .form-file-label {
            @apply p-6;
            min-height: 120px;
        }

        .form-group-inline {
            @apply flex-col items-stretch;
        }

        .form-group-inline label {
            @apply mb-2;
        }

        .form-group-split,
        .form-group-triple {
            @apply grid-cols-1 gap-3;
        }

        .form-actions {
            @apply flex-col;
        }

        .form-actions .btn {
            @apply w-full justify-center;
        }

        .shop-search-container {
            @apply max-w-none;
        }
    }

    /* ============================================================================
       プリファレンス対応
       ============================================================================ */

    @media (prefers-reduced-motion: reduce) {
        .form-input-base:focus,
        .form-textarea-base:focus,
        .form-select-base:focus {
            transform: none;
        }

        .form-file-label:hover {
            transform: none;
        }

        .form-message {
            animation: none;
        }

        .search-results.show {
            animation: none;
        }
    }

    /* ============================================================================
       高コントラスト対応
       ============================================================================ */

    @media (prefers-contrast: high) {
        .form-input-base,
        .form-textarea-base,
        .form-select-base {
            @apply border-2 border-neutral-600;
            background: white;
        }

        .form-input-base:focus,
        .form-textarea-base:focus,
        .form-select-base:focus {
            @apply border-neutral-900;
            box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.3);
        }

        .form-checkbox,
        .form-radio {
            @apply border-2 border-neutral-600;
            background: white;
        }
    }

    /* ============================================================================
       印刷対応
       ============================================================================ */

    @media print {
        .form-input-base,
        .form-textarea-base,
        .form-select-base {
            @apply border border-neutral-400;
            background: white !important;
            box-shadow: none !important;
        }

        .form-file-label {
            @apply border border-neutral-400;
            background: white !important;
        }

        .form-actions {
            display: none !important;
        }
    }
}
